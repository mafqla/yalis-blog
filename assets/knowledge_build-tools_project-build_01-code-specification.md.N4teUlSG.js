import{_ as e}from"./chunks/ArticleMetadata.1VcEe8Bb.js";import{_ as p,D as k,o as t,c as d,I as r,w as o,k as n,a as g,U as F,b as c,e as y}from"./chunks/framework.5FtAyiyV.js";import"./chunks/index.w40geAFS.js";import"./chunks/index.yNJctKkT.js";import"./chunks/commonjsHelpers.5-cIlDoe.js";const D="/assets/008i3skNgy1gsq2gh989yj30pj05ggmb.JhXK-11Z.jpg",B="/assets/008i3skNgy1gsq2acx21rj30ow057mxp.RDCegj_Z.jpg",C="/assets/008i3skNgy1gsq2oq26odj30pw05faaq.YUCYjXQ3.jpg",m="/assets/008i3skNgy1gsqq0o5jxmj30bb04qwen.F_cs9JwK.jpg",E="/assets/008i3skNgy1gsqq16zo75j307703mt8m.AGYLwx8E.jpg",u="/assets/008i3skNgy1gsqq26phpxj30dj06fgm3.xwUzQG1E.jpg",A="/assets/008i3skNgy1gsqq3hn229j30nf04z74q.IKHzERiB.jpg",f="/assets/008i3skNgy1gsqw17gaqjj30to0cj3zp.0dKdPzuV.jpg",v="/assets/008i3skNgy1gsqvz2odi4j30ek00zmx2.jdeRdVlf.jpg",b="/assets/008i3skNgy1gsqvzftay5j30iu04k74d.oOMHeQ0o.jpg",q="/assets/008i3skNgy1gsqw8ca15oj30r600wmx4.o-XMBVtm.jpg",_="/assets/008i3skNgy1gsqw8mq3zlj60ni01hmx402.1L5PtXFI.jpg",x="/assets/008i3skNgy1gsqw8y05bjj30kt01fjrb.XzfSzFUX.jpg",j="/assets/008i3skNgy1gsqw9z5vbij30bm00q744.WbYKRMx0.jpg",z="/assets/008i3skNgy1gsqwar8xp1j30fq00ya9x.8iRW3TSf.jpg",w="/assets/008i3skNgy1gsqwc4gtkxj30e207174t.y_dYrNaE.jpg",S="/assets/image-20210710121456416.1aBJQvwK.png",M=JSON.parse('{"title":"代码规范","description":"","frontmatter":{"title":"代码规范","date":"2022-8-21 18:51"},"headers":[],"relativePath":"knowledge/build-tools/project-build/01-code-specification.md","filePath":"knowledge/build-tools/project-build/01-code-specification.md","lastUpdated":1705148460000}'),N={name:"knowledge/build-tools/project-build/01-code-specification.md"},P=n("h1",{id:"一-代码规范",tabindex:"-1"},[g("一. 代码规范 "),n("a",{class:"header-anchor",href:"#一-代码规范","aria-label":'Permalink to "一. 代码规范"'},"​")],-1),L=F(`<h2 id="_1-1-集成editorconfig配置" tabindex="-1">1.1. 集成editorconfig配置 <a class="header-anchor" href="#_1-1-集成editorconfig配置" aria-label="Permalink to &quot;1.1. 集成editorconfig配置&quot;">​</a></h2><p>EditorConfig 有助于为不同 IDE 编辑器上处理同一项目的多个开发人员维护一致的编码风格。</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes one-dark-pro material-theme-palenight vp-code"><code><span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#676E95;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># http://editorconfig.org</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">root = true</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">[</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">*</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">]</span><span style="--shiki-light:#7F848E;--shiki-dark:#676E95;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"> # 表示所有文件适用</span></span>
<span class="line"><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">charset = utf-8</span><span style="--shiki-light:#7F848E;--shiki-dark:#676E95;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"> # 设置文件字符集为 utf-8</span></span>
<span class="line"><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">indent_style = space</span><span style="--shiki-light:#7F848E;--shiki-dark:#676E95;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"> # 缩进风格（tab | space）</span></span>
<span class="line"><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">indent_size = 2</span><span style="--shiki-light:#7F848E;--shiki-dark:#676E95;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"> # 缩进大小</span></span>
<span class="line"><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">end_of_line = lf</span><span style="--shiki-light:#7F848E;--shiki-dark:#676E95;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"> # 控制换行类型(lf | cr | crlf)</span></span>
<span class="line"><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">trim_trailing_whitespace = true</span><span style="--shiki-light:#7F848E;--shiki-dark:#676E95;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"> # 去除行首的任意空白字符</span></span>
<span class="line"><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">insert_final_newline = true</span><span style="--shiki-light:#7F848E;--shiki-dark:#676E95;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"> # 始终在文件末尾插入一个新行</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">[</span><span style="--shiki-light:#C678DD;--shiki-dark:#89DDFF;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">*</span><span style="--shiki-light:#E06C75;--shiki-dark:#BABED8;">.md</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">]</span><span style="--shiki-light:#7F848E;--shiki-dark:#676E95;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"> # 表示仅 md 文件适用以下规则</span></span>
<span class="line"><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">max_line_length = off</span></span>
<span class="line"><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">trim_trailing_whitespace = false</span></span></code></pre></div><p>VSCode需要安装一个插件：EditorConfig for VS Code</p><p><img src="`+D+`" alt="image-20210722215138665" loading="lazy"></p><h2 id="_1-2-使用prettier工具" tabindex="-1">1.2. 使用prettier工具 <a class="header-anchor" href="#_1-2-使用prettier工具" aria-label="Permalink to &quot;1.2. 使用prettier工具&quot;">​</a></h2><p>Prettier 是一款强大的代码格式化工具，支持 JavaScript、TypeScript、CSS、SCSS、Less、JSX、Angular、Vue、GraphQL、JSON、Markdown 等语言，基本上前端能用到的文件格式它都可以搞定，是当下最流行的代码格式化工具。</p><p><a href="https://www.prettier.cn/" target="_blank" rel="noreferrer"><code>prettier</code> 中文官网</a></p><p>1.安装prettier</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes one-dark-pro material-theme-palenight vp-code"><code><span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#FFCB6B;">npm</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;"> install</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;"> prettier</span><span style="--shiki-light:#D19A66;--shiki-dark:#C3E88D;"> -D</span></span></code></pre></div><p>2.配置.prettierrc文件：</p><ul><li>useTabs：使用tab缩进还是空格缩进，选择false；</li><li>tabWidth：tab是空格的情况下，是几个空格，选择2个；</li><li>printWidth：当行字符的长度，推荐80，也有人喜欢100或者120；</li><li>singleQuote：使用单引号还是双引号，选择true，使用单引号；</li><li>trailingComma：在多行输入的尾逗号是否添加，设置为 <code>none</code>；</li><li>semi：语句末尾是否要加分号，默认值true，选择false表示不加；</li></ul><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes one-dark-pro material-theme-palenight vp-code"><code><span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">{</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#89DDFF;">  &quot;</span><span style="--shiki-light:#E06C75;--shiki-dark:#C792EA;">useTabs</span><span style="--shiki-light:#E06C75;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#D19A66;--shiki-dark:#89DDFF;"> false</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">,</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#89DDFF;">  &quot;</span><span style="--shiki-light:#E06C75;--shiki-dark:#C792EA;">tabWidth</span><span style="--shiki-light:#E06C75;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#D19A66;--shiki-dark:#F78C6C;"> 2</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">,</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#89DDFF;">  &quot;</span><span style="--shiki-light:#E06C75;--shiki-dark:#C792EA;">printWidth</span><span style="--shiki-light:#E06C75;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#D19A66;--shiki-dark:#F78C6C;"> 80</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">,</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#89DDFF;">  &quot;</span><span style="--shiki-light:#E06C75;--shiki-dark:#C792EA;">singleQuote</span><span style="--shiki-light:#E06C75;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#D19A66;--shiki-dark:#89DDFF;"> true</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">,</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#89DDFF;">  &quot;</span><span style="--shiki-light:#E06C75;--shiki-dark:#C792EA;">trailingComma</span><span style="--shiki-light:#E06C75;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &quot;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">none</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">,</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#89DDFF;">  &quot;</span><span style="--shiki-light:#E06C75;--shiki-dark:#C792EA;">semi</span><span style="--shiki-light:#E06C75;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#D19A66;--shiki-dark:#89DDFF;"> false</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">}</span></span></code></pre></div><p>3.创建.prettierignore忽略文件</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes one-dark-pro material-theme-palenight vp-code"><code><span class="line"><span>/dist/*</span></span>
<span class="line"><span>.local</span></span>
<span class="line"><span>.output.js</span></span>
<span class="line"><span>/node_modules/**</span></span>
<span class="line"><span></span></span>
<span class="line"><span>**/*.svg</span></span>
<span class="line"><span>**/*.sh</span></span>
<span class="line"><span></span></span>
<span class="line"><span>/public/*</span></span></code></pre></div><p>4.VSCode需要安装prettier的插件</p><p><img src="`+B+`" alt="image-20210722214543454" loading="lazy"></p><p>5.测试prettier是否生效</p><ul><li>测试一：在代码中保存代码；</li><li>测试二：配置一次性修改的命令；</li></ul><p>在package.json中配置一个scripts：</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes one-dark-pro material-theme-palenight vp-code"><code><span class="line"><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">    &quot;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">prettier</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">: </span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">prettier --write .</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&quot;</span></span></code></pre></div><h2 id="_1-3-使用eslint检测" tabindex="-1">1.3. 使用ESLint检测 <a class="header-anchor" href="#_1-3-使用eslint检测" aria-label="Permalink to &quot;1.3. 使用ESLint检测&quot;">​</a></h2><p>在前面创建项目的时候，我们就选择了ESLint，所以Vue会默认帮助我们配置需要的ESLint环境。</p><p><code>.eslintrc.js配置文件</code></p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes one-dark-pro material-theme-palenight vp-code"><code><span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#89DDFF;">module</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">.</span><span style="--shiki-light:#E5C07B;--shiki-dark:#89DDFF;">exports</span><span style="--shiki-light:#56B6C2;--shiki-dark:#89DDFF;"> =</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;"> {</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#676E95;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">  // 表示当前目录即为根目录，ESLint 规则将被限制到该目录下</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#F07178;">  root</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#D19A66;--shiki-dark:#FF9CAC;"> true</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">,</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#676E95;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">  // env 表示启用 ESLint 检测的环境</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#F07178;">  env</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;"> {</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#676E95;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">    // 在 node 环境下启动 ESLint 检测</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#F07178;">    node</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#D19A66;--shiki-dark:#FF9CAC;"> true</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">  },</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#676E95;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">  // ESLint 中基础配置需要继承的配置</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#F07178;">  extends</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> [</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">plugin:vue/vue3-essential</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">,</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &quot;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">@vue/standard</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">]</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">,</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#676E95;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">  // 解析器</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#F07178;">  parserOptions</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;"> {</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#F07178;">    parser</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &quot;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">babel-eslint</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">  },</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#676E95;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">  // 需要修改的启用规则及其各自的错误级别</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#676E95;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">  /**</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#676E95;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">   * 错误级别分为三种：</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#676E95;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">   * &quot;off&quot; 或 0 - 关闭规则</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#676E95;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">   * &quot;warn&quot; 或 1 - 开启规则，使用警告级别的错误：warn (不会导致程序退出)</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#676E95;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">   * &quot;error&quot; 或 2 - 开启规则，使用错误级别的错误：error (当被触发的时候，程序会退出)</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#676E95;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">   */</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#F07178;">  rules</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;"> {</span></span>
<span class="line"><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">    &quot;</span><span style="--shiki-light:#98C379;--shiki-dark:#F07178;">no-console</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#E5C07B;--shiki-dark:#BABED8;"> process</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">.</span><span style="--shiki-light:#E5C07B;--shiki-dark:#BABED8;">env</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">.</span><span style="--shiki-light:#E06C75;--shiki-dark:#BABED8;">NODE_ENV</span><span style="--shiki-light:#56B6C2;--shiki-dark:#89DDFF;"> ===</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &quot;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">production</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#C678DD;--shiki-dark:#89DDFF;"> ?</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &quot;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">warn</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#C678DD;--shiki-dark:#89DDFF;"> :</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &quot;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">off</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">,</span></span>
<span class="line"><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">    &quot;</span><span style="--shiki-light:#98C379;--shiki-dark:#F07178;">no-debugger</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#E5C07B;--shiki-dark:#BABED8;"> process</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">.</span><span style="--shiki-light:#E5C07B;--shiki-dark:#BABED8;">env</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">.</span><span style="--shiki-light:#E06C75;--shiki-dark:#BABED8;">NODE_ENV</span><span style="--shiki-light:#56B6C2;--shiki-dark:#89DDFF;"> ===</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &quot;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">production</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#C678DD;--shiki-dark:#89DDFF;"> ?</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &quot;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">warn</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#C678DD;--shiki-dark:#89DDFF;"> :</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &quot;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">off</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">  }</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">};</span></span></code></pre></div><p><strong>修改 <code>ESLint</code> 的验证规则：</strong></p><ol><li><p>在 <code>.eslintrc.js</code> 文件中，新增一条验证规则</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes one-dark-pro material-theme-palenight vp-code"><code><span class="line"><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">quotes</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">: </span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">error</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#7F848E;--shiki-dark:#676E95;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"> // 默认</span></span>
<span class="line"><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">quotes</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">: </span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">warn</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#7F848E;--shiki-dark:#676E95;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"> // 修改为警告</span></span>
<span class="line"><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">quotes</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">: </span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">off</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#7F848E;--shiki-dark:#676E95;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"> // 修改不校验</span></span></code></pre></div></li></ol><p>2.VSCode需要安装ESLint插件：</p><p><img src="`+C+`" alt="image-20210722215933360" loading="lazy"></p><p>3.解决eslint和prettier冲突的问题：</p><p>安装插件：（vue在创建项目时，如果选择prettier，那么这两个插件会自动安装）</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes one-dark-pro material-theme-palenight vp-code"><code><span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#FFCB6B;">npm</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;"> i</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;"> eslint-plugin-prettier</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;"> eslint-config-prettier</span><span style="--shiki-light:#D19A66;--shiki-dark:#C3E88D;"> -D</span></span></code></pre></div><p>添加prettier插件：</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes one-dark-pro material-theme-palenight vp-code"><code><span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  extends: </span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">[</span></span>
<span class="line"><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">    &quot;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">plugin:vue/vue3-essential</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">,</span></span>
<span class="line"><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">    &quot;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">eslint:recommended</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">,</span></span>
<span class="line"><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">    &quot;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">@vue/typescript/recommended</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">,</span></span>
<span class="line"><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">    &quot;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">@vue/prettier</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">,</span></span>
<span class="line"><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">    &quot;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">@vue/prettier/@typescript-eslint</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">,</span></span>
<span class="line"><span style="--shiki-light:#FFFFFF;--shiki-dark:#BABED8;">    &#39;plugin:prettier/recommended&#39;</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">  ]</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">,</span></span></code></pre></div><p><code>prettier</code> 和 <code>ESLint</code> 的其他冲突问题。</p><ol><li><p>打开 <code>.eslintrc.js</code> 配置文件</p></li><li><p>在 <code>rules</code> 规则下，新增一条规则</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes one-dark-pro material-theme-palenight vp-code"><code><span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">&#39;space-before-function-paren&#39;: &#39;off&#39;</span></span></code></pre></div></li><li><p>该规则表示关闭《方法名后增加空格》的规则</p></li></ol><h2 id="_1-4-git-husky和eslint" tabindex="-1">1.4. git Husky和eslint <a class="header-anchor" href="#_1-4-git-husky和eslint" aria-label="Permalink to &quot;1.4. git Husky和eslint&quot;">​</a></h2><p>虽然我们已经要求项目使用eslint了，但是不能保证组员提交代码之前都将eslint中的问题解决掉了：</p><ul><li><p>也就是我们希望保证代码仓库中的代码都是符合eslint规范的；</p></li><li><p>那么我们需要在组员执行 <code>git commit </code> 命令的时候对其进行校验，如果不符合eslint规范，那么自动通过规范进行修复；</p></li></ul><p>那么如何做到这一点呢？可以通过Husky工具：</p><ul><li>husky是一个git hook工具，可以帮助我们触发git提交的各个阶段：pre-commit、commit-msg、pre-push</li></ul><p>如何使用husky呢？</p><p>这里我们可以使用自动配置命令：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes one-dark-pro material-theme-palenight vp-code"><code><span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#FFCB6B;">npx</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;"> husky-init</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;"> &amp;&amp;</span><span style="--shiki-light:#61AFEF;--shiki-dark:#FFCB6B;"> npm</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;"> install</span></span></code></pre></div><p>这里会做三件事：</p><p>1.安装husky相关的依赖：</p><p><code>限定版本：</code></p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes one-dark-pro material-theme-palenight vp-code"><code><span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#FFCB6B;">npm</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;"> install</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;"> husky@7.0.1</span><span style="--shiki-light:#D19A66;--shiki-dark:#C3E88D;"> --save-dev</span></span></code></pre></div><p><code>直接安装</code></p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes one-dark-pro material-theme-palenight vp-code"><code><span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#FFCB6B;">npm</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;"> install</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;"> husky</span><span style="--shiki-light:#D19A66;--shiki-dark:#C3E88D;"> --save-dev</span></span></code></pre></div><p><img src="`+m+'" alt="image-20210723112648927" loading="lazy"></p><p>2.在项目目录下创建 <code>.husky</code> 文件夹：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes one-dark-pro material-theme-palenight vp-code"><code><span class="line"><span>npx huksy install</span></span></code></pre></div><p><img src="'+E+'" alt="image-20210723112719634" loading="lazy"></p><p>3.在 <code>package.json</code> 中生成 <code>prepare</code> 指令（ <strong>需要 npm &gt; 7.0 版本</strong> ）：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes one-dark-pro material-theme-palenight vp-code"><code><span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#FFCB6B;">npm</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;"> set-script</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;"> prepare</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &quot;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">husky install</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&quot;</span></span></code></pre></div><p><img src="'+u+'" alt="image-20210723112817691" loading="lazy"></p><p>接下来，我们需要去完成一个操作：在进行commit时，执行lint脚本：</p><ol><li><p>执行 <code>npx husky add .husky/pre-commit &quot;npx eslint --ext .js,.vue src&quot;</code> 添加 <code>commit</code> 时的 <code>hook</code> （<code>npx eslint --ext .js,.vue src</code> 会在执行到该 hook 时运行）</p></li><li><p>该操作会生成对应文件 <code>pre-commit</code>：</p></li></ol><p><img src="'+A+'" alt="image-20210723112932943" loading="lazy"></p><p>这个时候我们执行git commit的时候会自动对代码进行lint校验。</p><h2 id="_1-5-git-commit规范" tabindex="-1">1.5. git commit规范 <a class="header-anchor" href="#_1-5-git-commit规范" aria-label="Permalink to &quot;1.5. git commit规范&quot;">​</a></h2><h3 id="_1-5-1-代码提交风格" tabindex="-1">1.5.1. 代码提交风格 <a class="header-anchor" href="#_1-5-1-代码提交风格" aria-label="Permalink to &quot;1.5.1. 代码提交风格&quot;">​</a></h3><p>通常我们的git commit会按照统一的风格来提交，这样可以快速定位每次提交的内容，方便之后对版本进行控制。</p><p><img src="'+f+'" alt="" loading="lazy"></p><p>但是如果每次手动来编写这些是比较麻烦的事情，我们可以使用一个工具：Commitizen</p><ul><li>Commitizen 是一个帮助我们编写规范 commit message 的工具；</li></ul><p>1.安装Commitizen</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes one-dark-pro material-theme-palenight vp-code"><code><span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#FFCB6B;">npm</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;"> install</span><span style="--shiki-light:#D19A66;--shiki-dark:#C3E88D;"> -g</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;"> commitizen@4.2.4</span></span></code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>使用自定义提交风格的话,不需要执行下一步。直接按照<a href="###1.5.2自定义提交风格">1.5.2</a>的步骤即可。</p></div><p>2.安装cz-conventional-changelog，并且初始化cz-conventional-changelog：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes one-dark-pro material-theme-palenight vp-code"><code><span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#FFCB6B;">npx</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;"> commitizen</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;"> init</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;"> cz-conventional-changelog</span><span style="--shiki-light:#D19A66;--shiki-dark:#C3E88D;"> --save-dev</span><span style="--shiki-light:#D19A66;--shiki-dark:#C3E88D;"> --save-exact</span></span></code></pre></div><p>这个命令会帮助我们安装cz-conventional-changelog：</p><p><img src="'+v+'" alt="image-20210723145249096" loading="lazy"></p><p>并且在package.json中进行配置：</p><p><img src="'+b+'" alt="" loading="lazy"></p><p>这个时候我们提交代码需要使用 <code>npx cz</code>：</p><ul><li>第一步是选择type，本次更新的类型</li></ul><table><thead><tr><th>Type</th><th>作用</th></tr></thead><tbody><tr><td>feat</td><td>新增特性 (feature)</td></tr><tr><td>fix</td><td>修复 Bug(bug fix)</td></tr><tr><td>docs</td><td>修改文档 (documentation)</td></tr><tr><td>style</td><td>代码格式修改(white-space, formatting, missing semi colons, etc)</td></tr><tr><td>refactor</td><td>代码重构(refactor)</td></tr><tr><td>perf</td><td>改善性能(A code change that improves performance)</td></tr><tr><td>test</td><td>测试(when adding missing tests)</td></tr><tr><td>build</td><td>变更项目构建或外部依赖（例如 scopes: webpack、gulp、npm 等）</td></tr><tr><td>ci</td><td>更改持续集成软件的配置文件和 package 中的 scripts 命令，例如 scopes: Travis, Circle 等</td></tr><tr><td>chore</td><td>变更构建流程或辅助工具(比如更改测试环境)</td></tr><tr><td>revert</td><td>代码回退</td></tr></tbody></table><ul><li>第二步选择本次修改的范围（作用域）</li></ul><p><img src="'+q+'" alt="image-20210723150147510" loading="lazy"></p><ul><li>第三步选择提交的信息</li></ul><p><img src="'+_+'" alt="image-20210723150204780" loading="lazy"></p><ul><li>第四步提交详细的描述信息</li></ul><p><img src="'+x+'" alt="image-20210723150223287" loading="lazy"></p><ul><li>第五步是否是一次重大的更改</li></ul><p><img src="'+j+'" alt="image-20210723150322122" loading="lazy"></p><ul><li>第六步是否影响某个open issue</li></ul><p><img src="'+z+'" alt="image-20210723150407822" loading="lazy"></p><p>我们也可以在scripts中构建一个命令来执行 cz：</p><p><img src="'+w+`" alt="image-20210723150526211" loading="lazy"></p><h3 id="_1-5-2自定义提交风格" tabindex="-1">1.5.2自定义提交风格 <a class="header-anchor" href="#_1-5-2自定义提交风格" aria-label="Permalink to &quot;1.5.2自定义提交风格&quot;">​</a></h3><ol><li><p>安装并配置 <code>cz-customizable</code> 插件</p><ol><li><p>使用 <code>npm</code> 下载 <code>cz-customizable</code></p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes one-dark-pro material-theme-palenight vp-code"><code><span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#FFCB6B;">npm</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;"> i</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;"> cz-customizable@6.3.0</span><span style="--shiki-light:#D19A66;--shiki-dark:#C3E88D;"> --save-dev</span></span></code></pre></div></li><li><p>添加以下配置到 <code>package.json </code> 中</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes one-dark-pro material-theme-palenight vp-code"><code><span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">...</span></span>
<span class="line"><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">  &quot;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">config</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">: </span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">{</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#89DDFF;">    &quot;</span><span style="--shiki-light:#E06C75;--shiki-dark:#C792EA;">commitizen</span><span style="--shiki-light:#E06C75;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;"> {</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#89DDFF;">      &quot;</span><span style="--shiki-light:#E06C75;--shiki-dark:#FFCB6B;">path</span><span style="--shiki-light:#E06C75;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &quot;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">node_modules/cz-customizable</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">    }</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">  }</span></span></code></pre></div></li></ol></li><li><p>项目根目录下创建 <code>.cz-config.js</code> 自定义提示文件</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes one-dark-pro material-theme-palenight vp-code"><code><span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#89DDFF;">module</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">.</span><span style="--shiki-light:#E5C07B;--shiki-dark:#89DDFF;">exports</span><span style="--shiki-light:#56B6C2;--shiki-dark:#89DDFF;"> =</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;"> {</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#676E95;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">  // 可选类型</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#F07178;">  types</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> [</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">    {</span><span style="--shiki-light:#E06C75;--shiki-dark:#F07178;"> value</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">feat</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">,</span><span style="--shiki-light:#E06C75;--shiki-dark:#F07178;"> name</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">feat:     新功能</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;"> },</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">    {</span><span style="--shiki-light:#E06C75;--shiki-dark:#F07178;"> value</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">fix</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">,</span><span style="--shiki-light:#E06C75;--shiki-dark:#F07178;"> name</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">fix:      修复</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;"> },</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">    {</span><span style="--shiki-light:#E06C75;--shiki-dark:#F07178;"> value</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">docs</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">,</span><span style="--shiki-light:#E06C75;--shiki-dark:#F07178;"> name</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">docs:     文档变更</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;"> },</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">    {</span><span style="--shiki-light:#E06C75;--shiki-dark:#F07178;"> value</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">style</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">,</span><span style="--shiki-light:#E06C75;--shiki-dark:#F07178;"> name</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">style:    代码格式(不影响代码运行的变动)</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;"> },</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">    {</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#F07178;">      value</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">refactor</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">,</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#F07178;">      name</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">refactor: 重构(既不是增加feature，也不是修复bug)</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">    },</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">    {</span><span style="--shiki-light:#E06C75;--shiki-dark:#F07178;"> value</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">perf</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">,</span><span style="--shiki-light:#E06C75;--shiki-dark:#F07178;"> name</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">perf:     性能优化</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;"> },</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">    {</span><span style="--shiki-light:#E06C75;--shiki-dark:#F07178;"> value</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">test</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">,</span><span style="--shiki-light:#E06C75;--shiki-dark:#F07178;"> name</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">test:     增加测试</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;"> },</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">    {</span><span style="--shiki-light:#E06C75;--shiki-dark:#F07178;"> value</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">chore</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">,</span><span style="--shiki-light:#E06C75;--shiki-dark:#F07178;"> name</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">chore:    构建过程或辅助工具的变动</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;"> },</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">    {</span><span style="--shiki-light:#E06C75;--shiki-dark:#F07178;"> value</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">revert</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">,</span><span style="--shiki-light:#E06C75;--shiki-dark:#F07178;"> name</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">revert:   回退</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;"> },</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">    {</span><span style="--shiki-light:#E06C75;--shiki-dark:#F07178;"> value</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">build</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">,</span><span style="--shiki-light:#E06C75;--shiki-dark:#F07178;"> name</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">build:    打包</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;"> }</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  ]</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">,</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#676E95;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">  // 消息步骤</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#F07178;">  messages</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;"> {</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#F07178;">    type</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">请选择提交类型:</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">,</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#F07178;">    customScope</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">请输入修改范围(可选):</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">,</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#F07178;">    subject</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">请简要描述提交(必填):</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">,</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#F07178;">    body</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">请输入详细描述(可选):</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">,</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#F07178;">    footer</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">请输入要关闭的issue(可选):</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">,</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#F07178;">    confirmCommit</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">确认使用以上信息提交？(y/n/e/h)</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">  },</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#676E95;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">  // 跳过问题</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#F07178;">  skipQuestions</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> [</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">body</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">,</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">footer</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">]</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">,</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#676E95;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">  // subject文字长度默认是72</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#F07178;">  subjectLimit</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#D19A66;--shiki-dark:#F78C6C;"> 72</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">}</span></span></code></pre></div></li><li><p>使用 <code>git cz</code> 代替 <code>git commit</code> 使用 <code>git cz</code> 代替 <code>git commit</code>，即可看到提示内容</p></li></ol><h3 id="_1-5-3-什么是-git-hooks" tabindex="-1">1.5.3 什么是 Git Hooks <a class="header-anchor" href="#_1-5-3-什么是-git-hooks" aria-label="Permalink to &quot;1.5.3  什么是 Git Hooks&quot;">​</a></h3><p>上一小节中我们使用了 <code>git cz</code> 来代替了 <code>git commit</code> 实现了规范化的提交诉求，但是依然存在着有人会忘记使用的问题。</p><p>那么这一小节我们就来看一下这样的问题，我们应该如何去进行解决。</p><p>先来明确一下我们最终要实现的效果：</p><blockquote><p>我们希望：</p><p>当《提交描述信息》不符合 <a href="https://www.conventionalcommits.org/zh-hans/v1.0.0/" target="_blank" rel="noreferrer">约定式提交规范</a> 的时候，阻止当前的提交，并抛出对应的错误提示</p></blockquote><p>而要实现这个目的，我们就需要先来了解一个概念，叫做 <code>Git hooks（git 钩子 || git 回调方法）</code></p><p>也就是：<strong><code>git</code> 在执行某个事件之前或之后进行一些其他额外的操作</strong></p><p>而我们所期望的 <strong>阻止不合规的提交消息</strong>，那么就需要使用到 <code>hooks</code> 的钩子函数。</p><p>下面是我整理出来的所有的 <code>hooks</code> ，大家可以进行一下参考，其中加粗的是常用到的 <code>hooks</code>：</p><table><thead><tr><th style="text-align:left;">Git Hook</th><th>调用时机</th><th>说明</th></tr></thead><tbody><tr><td style="text-align:left;">pre-applypatch</td><td><code>git am</code>执行前</td><td></td></tr><tr><td style="text-align:left;">applypatch-msg</td><td><code>git am</code>执行前</td><td></td></tr><tr><td style="text-align:left;">post-applypatch</td><td><code>git am</code>执行后</td><td>不影响<code>git am</code>的结果</td></tr><tr><td style="text-align:left;"><strong>pre-commit</strong></td><td><code>git commit</code>执行前</td><td>可以用<code>git commit --no-verify</code>绕过</td></tr><tr><td style="text-align:left;"><strong>commit-msg</strong></td><td><code>git commit</code>执行前</td><td>可以用<code>git commit --no-verify</code>绕过</td></tr><tr><td style="text-align:left;">post-commit</td><td><code>git commit</code>执行后</td><td>不影响<code>git commit</code>的结果</td></tr><tr><td style="text-align:left;">pre-merge-commit</td><td><code>git merge</code>执行前</td><td>可以用<code>git merge --no-verify</code>绕过。</td></tr><tr><td style="text-align:left;">prepare-commit-msg</td><td><code>git commit</code>执行后，编辑器打开之前</td><td></td></tr><tr><td style="text-align:left;">pre-rebase</td><td><code>git rebase</code>执行前</td><td></td></tr><tr><td style="text-align:left;">post-checkout</td><td><code>git checkout</code>或<code>git switch</code>执行后</td><td>如果不使用<code>--no-checkout</code>参数，则在<code>git clone</code>之后也会执行。</td></tr><tr><td style="text-align:left;">post-merge</td><td><code>git commit</code>执行后</td><td>在执行<code>git pull</code>时也会被调用</td></tr><tr><td style="text-align:left;">pre-push</td><td><code>git push</code>执行前</td><td></td></tr><tr><td style="text-align:left;">pre-receive</td><td><code>git-receive-pack</code>执行前</td><td></td></tr><tr><td style="text-align:left;">update</td><td></td><td></td></tr><tr><td style="text-align:left;">post-receive</td><td><code>git-receive-pack</code>执行后</td><td>不影响<code>git-receive-pack</code>的结果</td></tr><tr><td style="text-align:left;">post-update</td><td>当 <code>git-receive-pack</code>对 <code>git push</code> 作出反应并更新仓库中的引用时</td><td></td></tr><tr><td style="text-align:left;">push-to-checkout</td><td>当\`\`git-receive-pack<code>对</code>git push<code>做出反应并更新仓库中的引用时，以及当推送试图更新当前被签出的分支且</code>receive.denyCurrentBranch<code>配置被设置为</code>updateInstead\`时</td><td></td></tr><tr><td style="text-align:left;">pre-auto-gc</td><td><code>git gc --auto</code>执行前</td><td></td></tr><tr><td style="text-align:left;">post-rewrite</td><td>执行<code>git commit --amend</code>或<code>git rebase</code>时</td><td></td></tr><tr><td style="text-align:left;">sendemail-validate</td><td><code>git send-email</code>执行前</td><td></td></tr><tr><td style="text-align:left;">fsmonitor-watchman</td><td>配置<code>core.fsmonitor</code>被设置为<code>.git/hooks/fsmonitor-watchman</code>或<code>.git/hooks/fsmonitor-watchmanv2</code>时</td><td></td></tr><tr><td style="text-align:left;">p4-pre-submit</td><td><code>git-p4 submit</code>执行前</td><td>可以用<code>git-p4 submit --no-verify</code>绕过</td></tr><tr><td style="text-align:left;">p4-prepare-changelist</td><td><code>git-p4 submit</code>执行后，编辑器启动前</td><td>可以用<code>git-p4 submit --no-verify</code>绕过</td></tr><tr><td style="text-align:left;">p4-changelist</td><td><code>git-p4 submit</code>执行并编辑完<code>changelist message</code>后</td><td>可以用<code>git-p4 submit --no-verify</code>绕过</td></tr><tr><td style="text-align:left;">p4-post-changelist</td><td><code>git-p4 submit</code>执行后</td><td></td></tr><tr><td style="text-align:left;">post-index-change</td><td>索引被写入到<code>read-cache.c do_write_locked_index</code>后</td><td></td></tr></tbody></table><p>PS：详细的 <code>HOOKS介绍</code> 可点击<a href="https://git-scm.com/docs/githooks" target="_blank" rel="noreferrer">这里</a>查看</p><p>整体的 <code>hooks</code> 非常多，当时我们其中用的比较多的其实只有两个：</p><table><thead><tr><th style="text-align:left;">Git Hook</th><th>调用时机</th><th>说明</th></tr></thead><tbody><tr><td style="text-align:left;"><strong>pre-commit</strong></td><td><code>git commit</code>执行前<br>它不接受任何参数，并且在获取提交日志消息并进行提交之前被调用。脚本<code>git commit</code>以非零状态退出会导致命令在创建提交之前中止。</td><td>可以用<code>git commit --no-verify</code>绕过</td></tr><tr><td style="text-align:left;"><strong>commit-msg</strong></td><td><code>git commit</code>执行前<br>可用于将消息规范化为某种项目标准格式。<br>还可用于在检查消息文件后拒绝提交。</td><td>可以用<code>git commit --no-verify</code>绕过</td></tr></tbody></table><p>简单来说这两个钩子：</p><ol><li><code>commit-msg</code>：可以用来规范化标准格式，并且可以按需指定是否要拒绝本次提交</li><li><code>pre-commit</code>：会在提交前被调用，并且可以按需指定是否要拒绝本次提交</li></ol><h3 id="_1-5-4-代码提交验证" tabindex="-1">1.5.4. 代码提交验证 <a class="header-anchor" href="#_1-5-4-代码提交验证" aria-label="Permalink to &quot;1.5.4. 代码提交验证&quot;">​</a></h3><p>如果我们按照cz来规范了提交风格，但是依然有同事通过 <code>git commit</code> 按照不规范的格式提交应该怎么办呢？</p><ol><li><p><a href="https://github.com/conventional-changelog/commitlint" target="_blank" rel="noreferrer">commitlint</a>：用于检查提交信息</p></li><li><p><a href="https://github.com/typicode/husky" target="_blank" rel="noreferrer">husky</a>：是<code>git hooks</code>工具</p></li></ol><p>注意：<strong><code>npm</code> 需要在 7.x 以上版本！！！！！</strong></p><p><strong>commitlint</strong></p><ol><li><p>安装 @commitlint/config-conventional 和 @commitlint/cli</p><p><code>限定版本安装：</code></p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes one-dark-pro material-theme-palenight vp-code"><code><span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#FFCB6B;">npm</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;"> install</span><span style="--shiki-light:#D19A66;--shiki-dark:#C3E88D;"> --save-dev</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;"> @commitlint/config-conventional@12.1.4</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;"> @commitlint/cli@12.1.4</span></span></code></pre></div><p><code>直接安装:</code></p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes one-dark-pro material-theme-palenight vp-code"><code><span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#FFCB6B;">npm</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;"> i</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;"> @commitlint/config-conventional</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;"> @commitlint/cli</span><span style="--shiki-light:#D19A66;--shiki-dark:#C3E88D;"> -D</span></span></code></pre></div></li><li><p>在根目录创建 <code>commitlint.config.js</code> ，配置commitlint文件</p><p><code>直接使用命令行</code></p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes one-dark-pro material-theme-palenight vp-code"><code><span class="line"><span style="--shiki-light:#56B6C2;--shiki-dark:#82AAFF;">echo</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &quot;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">module.exports = {extends: [&#39;@commitlint/config-conventional&#39;]}</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;"> &gt;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;"> commitlint.config.js</span></span></code></pre></div><p><code>手动创建</code></p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes one-dark-pro material-theme-palenight vp-code"><code><span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#89DDFF;">module</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">.</span><span style="--shiki-light:#E5C07B;--shiki-dark:#89DDFF;">exports</span><span style="--shiki-light:#56B6C2;--shiki-dark:#89DDFF;"> =</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;"> {</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#F07178;">  extends</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> [</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">@commitlint/config-conventional</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">]</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">}</span></span></code></pre></div></li><li><p>打开 <code>commitlint.config.js</code> ， 增加配置项（ <a href="https://github.com/conventional-changelog/commitlint/blob/master/@commitlint/config-conventional/index.js" target="_blank" rel="noreferrer">config-conventional 默认配置点击可查看</a> ）：</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes one-dark-pro material-theme-palenight vp-code"><code><span class="line"><span style="--shiki-light:#E5C07B;--shiki-dark:#89DDFF;">module</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">.</span><span style="--shiki-light:#E5C07B;--shiki-dark:#89DDFF;">exports</span><span style="--shiki-light:#56B6C2;--shiki-dark:#89DDFF;"> =</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;"> {</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#676E95;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">  // 继承的规则</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#F07178;">  extends</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> [</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">@commitlint/config-conventional</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">]</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">,</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#676E95;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">  // 定义规则类型</span></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#F07178;">  rules</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;"> {</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#676E95;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">    // type 类型定义，表示 git 提交的 type 必须在以下类型范围内</span></span>
<span class="line"><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">    &#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#F07178;">type-enum</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> [</span></span>
<span class="line"><span style="--shiki-light:#D19A66;--shiki-dark:#F78C6C;">      2</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">,</span></span>
<span class="line"><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">      &#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">always</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">,</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">      [</span></span>
<span class="line"><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">        &#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">feat</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">,</span><span style="--shiki-light:#7F848E;--shiki-dark:#676E95;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"> // 新功能 feature</span></span>
<span class="line"><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">        &#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">fix</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">,</span><span style="--shiki-light:#7F848E;--shiki-dark:#676E95;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"> // 修复 bug</span></span>
<span class="line"><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">        &#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">docs</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">,</span><span style="--shiki-light:#7F848E;--shiki-dark:#676E95;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"> // 文档注释</span></span>
<span class="line"><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">        &#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">style</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">,</span><span style="--shiki-light:#7F848E;--shiki-dark:#676E95;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"> // 代码格式(不影响代码运行的变动)</span></span>
<span class="line"><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">        &#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">refactor</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">,</span><span style="--shiki-light:#7F848E;--shiki-dark:#676E95;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"> // 重构(既不增加新功能，也不是修复bug)</span></span>
<span class="line"><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">        &#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">perf</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">,</span><span style="--shiki-light:#7F848E;--shiki-dark:#676E95;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"> // 性能优化</span></span>
<span class="line"><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">        &#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">test</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">,</span><span style="--shiki-light:#7F848E;--shiki-dark:#676E95;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"> // 增加测试</span></span>
<span class="line"><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">        &#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">chore</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">,</span><span style="--shiki-light:#7F848E;--shiki-dark:#676E95;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"> // 构建过程或辅助工具的变动</span></span>
<span class="line"><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">        &#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">revert</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">,</span><span style="--shiki-light:#7F848E;--shiki-dark:#676E95;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"> // 回退</span></span>
<span class="line"><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">        &#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">build</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#7F848E;--shiki-dark:#676E95;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"> // 打包</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">      ]</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">    ]</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">,</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#676E95;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">    // subject 大小写不做校验</span></span>
<span class="line"><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">    &#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#F07178;">subject-case</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> [</span><span style="--shiki-light:#D19A66;--shiki-dark:#F78C6C;">0</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">]</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">  }</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">}</span></span></code></pre></div></li><li><p>使用husky生成commit-msg文件，验证提交信息：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes one-dark-pro material-theme-palenight vp-code"><code><span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#FFCB6B;">npx</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;"> husky</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;"> add</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;"> .husky/commit-msg</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &quot;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">npx --no-install commitlint --edit </span><span style="--shiki-light:#E06C75;--shiki-dark:#BABED8;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">$1</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&quot;</span></span></code></pre></div></li><li><p>此时的 <code>.husky</code> 的文件结构 ![image-20210710120228931](../../../Nodes-master/nodes/第二章：标准化大厂编程规范解决方案之ESLint + Git Hooks .assets/image-20210710120228931.png)</p></li></ol><p>至此， 不符合规范的 commit 将不再可提交：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes one-dark-pro material-theme-palenight vp-code"><code><span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#FFCB6B;">PS</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;"> F:</span><span style="--shiki-light:#56B6C2;--shiki-dark:#BABED8;">\\x</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">xxxxxxxxxxxxxxxxxxxx</span><span style="--shiki-light:#56B6C2;--shiki-dark:#BABED8;">\\i</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">mooc-admi</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">n</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">&gt;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;"> git</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;"> commit</span><span style="--shiki-light:#D19A66;--shiki-dark:#C3E88D;"> -m</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &quot;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">测试</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#FFCB6B;">⧗</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">   input:</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;"> 测试</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#FFCB6B;">✖</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">   subject</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;"> may</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;"> not</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;"> be</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;"> empty</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> [subject-empty]</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#FFCB6B;">✖</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">   type</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;"> may</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;"> not</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;"> be</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;"> empty</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> [type-empty]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#FFCB6B;">✖</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">   found</span><span style="--shiki-light:#D19A66;--shiki-dark:#F78C6C;"> 2</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;"> problems,</span><span style="--shiki-light:#D19A66;--shiki-dark:#F78C6C;"> 0</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;"> warnings</span></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#FFCB6B;">ⓘ</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">   Get</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;"> help:</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;"> https://github.com/conventional-changelog/commitlint/#what-is-commitlint</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#61AFEF;--shiki-dark:#FFCB6B;">husky</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;"> -</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;"> commit-msg</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;"> hook</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;"> exited</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;"> with</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;"> code</span><span style="--shiki-light:#D19A66;--shiki-dark:#F78C6C;"> 1</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> (error)</span></span></code></pre></div><p><strong>注意：确保保存为 <code>UTF-8</code> 的编码格式</strong>，否则可能会出现以下错误：</p><p><img src="`+S+`" alt="image-20210710121456416" loading="lazy"></p><h3 id="_1-5-5-lint-staged-自动修复格式错误" tabindex="-1">1.5.5 lint-staged 自动修复格式错误 <a class="header-anchor" href="#_1-5-5-lint-staged-自动修复格式错误" aria-label="Permalink to &quot;1.5.5 lint-staged 自动修复格式错误&quot;">​</a></h3><p><a href="https://github.com/okonet/lint-staged" target="_blank" rel="noreferrer">lint-staged</a> 可以让你当前的代码检查 <strong>只检查本次修改更新的代码，并在出现错误的时候，自动修复并且推送</strong></p><p><a href="https://github.com/okonet/lint-staged" target="_blank" rel="noreferrer">lint-staged</a> 无需单独安装，我们生成项目时，<code>vue-cli</code> 已经帮助我们安装过了，所以我们直接使用就可以了</p><ol><li><p>修改 <code>package.json</code> 配置</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes one-dark-pro material-theme-palenight vp-code"><code><span class="line"><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">lint-staged</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">: </span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">{</span></span>
<span class="line"><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">    &quot;</span><span style="--shiki-light:#98C379;--shiki-dark:#F07178;">src/**/*.{js,vue}</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> [</span></span>
<span class="line"><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">      &quot;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">eslint --fix</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">,</span></span>
<span class="line"><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">      &quot;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">git add</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">    ]</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">  }</span></span></code></pre></div></li><li><p>如上配置，每次它只会在你本地 <code>commit</code> 之前，校验你提交的内容是否符合你本地配置的 <code>eslint</code>规则(这个见文档 <a href="https://panjiachen.github.io/vue-element-admin-site/zh/guide/advanced/eslint.html" target="_blank" rel="noreferrer">ESLint</a> )，校验会出现两种结果：</p><ol><li>如果符合规则：则会提交成功。</li><li>如果不符合规则：它会自动执行 <code>eslint --fix</code> 尝试帮你自动修复，如果修复成功则会帮你把修复好的代码提交，如果失败，则会提示你错误，让你修好这个错误之后才能允许你提交代码。</li></ol></li><li><p>修改 <code>.husky/pre-commit</code> 文件</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes one-dark-pro material-theme-palenight vp-code"><code><span class="line"><span style="--shiki-light:#7F848E;--shiki-dark:#676E95;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">#!/bin/sh</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">.</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &quot;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">$(dirname </span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#E06C75;--shiki-dark:#BABED8;">$0</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">)/_/husky.sh</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E06C75;--shiki-dark:#BABED8;">npx</span><span style="--shiki-light:#E06C75;--shiki-dark:#BABED8;"> lint</span><span style="--shiki-light:#56B6C2;--shiki-dark:#89DDFF;">-</span><span style="--shiki-light:#E06C75;--shiki-dark:#BABED8;">staged</span></span></code></pre></div></li><li><p>再次执行提交代码</p></li><li><p>发现 <strong>暂存区中</strong> 不符合 <code>ESlint</code> 的内容，被自动修复</p></li></ol>`,122);function V(s,T,H,G,O,$){const l=e,h=k("ClientOnly");return t(),d("div",null,[P,r(h,null,{default:o(()=>{var i,a;return[(((i=s.$frontmatter)==null?void 0:i.aside)??!0)&&(((a=s.$frontmatter)==null?void 0:a.showArticleMetadata)??!0)?(t(),c(l,{key:0,article:s.$frontmatter},null,8,["article"])):y("",!0)]}),_:1}),L])}const R=p(N,[["render",V]]);export{M as __pageData,R as default};
